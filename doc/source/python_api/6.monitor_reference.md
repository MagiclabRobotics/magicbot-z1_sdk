---
title: 状态监控服务
createTime: 2025/01/27 10:18:56
permalink: /human-z1/python_monitor_reference/
---

# 状态监控服务 (Python)

> 提供机器人状态监控接口类，通过StateMonitor可以提供状态查询等接口。

## 接口定义
`StateMonitor` 是机器人系统状态监控管理类，该类通常用于控制机器人的状态管理，支持状态查询。

### get_current_state
<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;">函数名</td>
      <td style="text-align: left;"><code>get_current_state</code></td>
    </tr>
    <tr>
      <td style="text-align: left;">函数声明</td>
      <td style="text-align: left;"><code>RobotState get_current_state()</code></td>
    </tr>
    <tr>
      <td style="text-align: left;">功能概述</td>
      <td style="text-align: left;">获取当前机器人聚合状态</td>
    </tr>
    <tr>
      <td style="text-align: left;">返回值</td>
      <td style="text-align: left;"><code>RobotState</code> 对象</td>
    </tr>
    <tr>
      <td style="text-align: left;">备注</td>
      <td style="text-align: left;">非阻塞接口，获取最近监控到的机器人状态数据，包括BMS/故障状态监控等，后续会迭代拓展</td>
    </tr>
  </tbody>
</table>

### `RobotState` — 机器人状态数据结构体

用于表示机器人总体状态信息：

<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 30%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 30%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;"><code>faults</code></td>
      <td style="text-align: left;"><code>list[Fault]</code></td>
      <td style="text-align: left;">故障信息列表</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>bms_data</code></td>
      <td style="text-align: left;"><code>BmsData</code></td>
      <td style="text-align: left;">电池管理系统数据</td>
    </tr>
  </tbody>
</table>

### `BmsData` — 电池管理系统数据结构体

表示电池的状态信息：

<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 30%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 30%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;"><code>battery_percentage</code></td>
      <td style="text-align: left;"><code>float</code></td>
      <td style="text-align: left;">当前电池剩余电量（百分比，0~100）</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>battery_health</code></td>
      <td style="text-align: left;"><code>float</code></td>
      <td style="text-align: left;">电池健康状态（越高越好）</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>battery_state</code></td>
      <td style="text-align: left;"><code>BatteryState</code></td>
      <td style="text-align: left;">电池状态（见下方枚举）</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>power_supply_status</code></td>
      <td style="text-align: left;"><code>PowerSupplyStatus</code></td>
      <td style="text-align: left;">电池充放电状态（见下方枚举）</td>
    </tr>
  </tbody>
</table>

### 枚举类型定义

#### `BatteryState` — 电池状态枚举类型

用于表示电池当前的状态，用于系统中电池状态的判断和处理：

<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;"><code>BatteryState.UNKNOWN</code></td>
      <td style="text-align: center;">0</td>
      <td style="text-align: left;">未知状态</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.GOOD</code></td>
      <td style="text-align: center;">1</td>
      <td style="text-align: left;">电池状态良好</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.OVERHEAT</code></td>
      <td style="text-align: center;">2</td>
      <td style="text-align: left;">电池过热</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.DEAD</code></td>
      <td style="text-align: center;">3</td>
      <td style="text-align: left;">电池损坏</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.OVERVOLTAGE</code></td>
      <td style="text-align: center;">4</td>
      <td style="text-align: left;">电池过电压</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.UNSPEC_FAILURE</code></td>
      <td style="text-align: center;">5</td>
      <td style="text-align: left;">未知故障</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.COLD</code></td>
      <td style="text-align: center;">6</td>
      <td style="text-align: left;">电池过冷</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.WATCHDOG_TIMER_EXPIRE</code></td>
      <td style="text-align: center;">7</td>
      <td style="text-align: left;">看门狗定时器超时</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>BatteryState.SAFETY_TIMER_EXPIRE</code></td>
      <td style="text-align: center;">8</td>
      <td style="text-align: left;">安全定时器超时</td>
    </tr>
  </tbody>
</table>

#### `PowerSupplyStatus` — 电池充放电状态

用于表示当前电池的充放电状态：

<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left;"><code>PowerSupplyStatus.UNKNOWN</code></td>
      <td style="text-align: center;">0</td>
      <td style="text-align: left;">未知状态</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>PowerSupplyStatus.CHARGING</code></td>
      <td style="text-align: center;">1</td>
      <td style="text-align: left;">电池充电中</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>PowerSupplyStatus.DISCHARGING</code></td>
      <td style="text-align: center;">2</td>
      <td style="text-align: left;">电池放电中</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>PowerSupplyStatus.NOTCHARGING</code></td>
      <td style="text-align: center;">3</td>
      <td style="text-align: left;">电池未充放电</td>
    </tr>
    <tr>
      <td style="text-align: left;"><code>PowerSupplyStatus.FULL</code></td>
      <td style="text-align: center;">4</td>
      <td style="text-align: left;">电池充满</td>
    </tr>
  </tbody>
</table>

## 错误码映射表

<table style="width: 100%; table-layout: fixed; border-collapse: collapse;">
  <thead>
    <tr>
      <th style="width: 30%; text-align: center;"><strong>错误码（十六进制）</strong></th>
      <th style="width: 70%; text-align: center;"><strong>错误描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center;">0x0000</td>
      <td style="text-align: left;">No fault</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1101</td>
      <td style="text-align: left;">Service invocation failed</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1301</td>
      <td style="text-align: left;">Central control node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1302</td>
      <td style="text-align: left;">App node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1303</td>
      <td style="text-align: left;">Audio node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1304</td>
      <td style="text-align: left;">Stereo camera node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1305</td>
      <td style="text-align: left;">LIDAR node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1306</td>
      <td style="text-align: left;">SLAM node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1307</td>
      <td style="text-align: left;">Navigation node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1308</td>
      <td style="text-align: left;">AI node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x1309</td>
      <td style="text-align: left;">Head node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x130A</td>
      <td style="text-align: left;">Point cloud node lost</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x2201</td>
      <td style="text-align: left;">No LIDAR data received</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x2202</td>
      <td style="text-align: left;">No stereo camera data received</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x2203</td>
      <td style="text-align: left;">Stereo camera data error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x2204</td>
      <td style="text-align: left;">Stereo camera initialization failed</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x220B</td>
      <td style="text-align: left;">No odometry data received</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x220C</td>
      <td style="text-align: left;">No IMU data received</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x2215</td>
      <td style="text-align: left;">Depth camera not detected</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x3101</td>
      <td style="text-align: left;">Failed to connect robot to app</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x3102</td>
      <td style="text-align: left;">Heartbeat lost - assertion failed</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x4201</td>
      <td style="text-align: left;">Failed to open head serial port</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x4202</td>
      <td style="text-align: left;">No head data received</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5201</td>
      <td style="text-align: left;">No navigation TF data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5202</td>
      <td style="text-align: left;">No navigation map data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5203</td>
      <td style="text-align: left;">No navigation localization data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5204</td>
      <td style="text-align: left;">No navigation LIDAR data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5205</td>
      <td style="text-align: left;">No navigation depth camera data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5206</td>
      <td style="text-align: left;">No navigation multi-line LIDAR data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x5207</td>
      <td style="text-align: left;">No navigation odometry data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x6201</td>
      <td style="text-align: left;">SLAM localization error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x6102</td>
      <td style="text-align: left;">No SLAM LIDAR data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x6103</td>
      <td style="text-align: left;">No SLAM odometry data</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x6104</td>
      <td style="text-align: left;">SLAM map data error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x7201</td>
      <td style="text-align: left;">LCM connection timeout</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8201</td>
      <td style="text-align: left;">Left leg hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8202</td>
      <td style="text-align: left;">Right leg hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8203</td>
      <td style="text-align: left;">Left arm hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8204</td>
      <td style="text-align: left;">Right arm hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8205</td>
      <td style="text-align: left;">Waist hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8206</td>
      <td style="text-align: left;">Head hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8207</td>
      <td style="text-align: left;">Hand hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8208</td>
      <td style="text-align: left;">Gripper hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x8209</td>
      <td style="text-align: left;">IMU hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x820A</td>
      <td style="text-align: left;">Power system hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x820B</td>
      <td style="text-align: left;">Leg force sensor hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x820C</td>
      <td style="text-align: left;">Arm force sensor hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0x9201</td>
      <td style="text-align: left;">ECAT (EtherCAT) hardware error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0xA201</td>
      <td style="text-align: left;">Motion posture error</td>
    </tr>
    <tr>
      <td style="text-align: center;">0xA202</td>
      <td style="text-align: left;">Foot position deviation during movement</td>
    </tr>
    <tr>
      <td style="text-align: center;">0xA203</td>
      <td style="text-align: left;">Joint velocity error during motion</td>
    </tr>
  </tbody>
</table>
